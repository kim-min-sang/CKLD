2025-08-27 23:03:16,984 - root - INFO - Running with configuration:
{'accumulate_data': False,
 'al': True,
 'al_epochs': 50,
 'al_optimizer': None,
 'benign_zero': True,
 'bsize': 1024,
 'cae_batch_size': 64,
 'cae_epochs': 250,
 'cae_hidden': None,
 'cae_lambda': 0.1,
 'cae_lr': 0.001,
 'classifier': 'enc-kld-custom-mlp-ensemble6',
 'cls_feat': 'input',
 'cls_retrain': 0,
 'clsdate': None,
 'cold_start': False,
 'count': None,
 'criteria': 'cred',
 'data': 'gen_androzoo_drebin',
 'display_interval': 180,
 'enc_hidden': '512-384-256-128',
 'encoder': 'enc-kld-custom-mlp-ensemble6',
 'encoder_retrain': True,
 'epochs': 2,
 'eta': 0.3,
 'eval_multi': False,
 'is_accum_samples_load': 0,
 'is_accum_samples_save': 0,
 'is_draw_tsne': 0,
 'is_enc_kld_custom_mid': 1,
 'is_only_test_eval_without_al': 1,
 'is_ovl': 0,
 'is_valid': 0,
 'kld_anneal_init': 0.1,
 'kld_anneal_warm': 0.2,
 'kld_beta': 1,
 'kld_scale': 3.0,
 'learning_rate': 5e-05,
 'local_pseudo_loss': True,
 'log_path': None,
 'loss_func': 'hi-dist-kld-custom-xent-ensemble6',
 'lr_decay_epochs': [range(10, 500, 10)],
 'lr_decay_rate': 0.5,
 'mad_threshold': 3.5,
 'margin': 10.0,
 'margin_between_b_and_m': 2.0,
 'max_depth': 6,
 'mdate': None,
 'mid_type': 'bin',
 'min_per_class': 2,
 'mlp_batch_size': 32,
 'mlp_display_interval': 300,
 'mlp_dropout': 0.2,
 'mlp_epochs': 50,
 'mlp_hidden': '100-100',
 'mlp_lr': 0.001,
 'mlp_warm_epochs': 50,
 'mlp_warm_lr': 0.001,
 'mse_lambda': 1,
 'multi_class': False,
 'num_round': 10,
 'ood': False,
 'ood_kld_ensemble': False,
 'optimizer': 'adam',
 'plb': None,
 'rand': False,
 'reduce': 'none',
 'result': 'experiments/020_revision/hc_results/hc_androzoo_mt',
 'retrain_first': 1,
 'sample_per_class': 2,
 'sample_reduce': 'mean',
 'sampler': 'half',
 'scheduler': 'step',
 'sleep': 0,
 'snapshot': False,
 'step_month': 1,
 'svm_c': 1.0,
 'test_end': '2021-12',
 'test_start': '2020-01',
 'train': None,
 'train_end': '2019-12',
 'train_start': '2019-01',
 'transcend': False,
 'triplet_lambda': 1.0,
 'unc': False,
 'valid_date': '2020-06',
 'verbose': False,
 'warm_learning_rate': 0.001,
 'xent_lambda': 100.0}
2025-08-27 23:03:16,984 - root - INFO - Loading gen_androzoo_drebin training dataset
2025-08-27 23:03:23,471 - root - INFO - Loaded X_train: (45489, 16978), (45489,)
2025-08-27 23:03:23,473 - root - INFO - y_train labels: [  0.   1.   2.   3.   4.   5.   6.   7.   8.   9.  10.  11.  12.  13.
  14.  15.  16.  17.  18.  19.  20.  21.  22.  23.  24.  25.  26.  27.
  28.  29.  30.  31.  32.  33.  34.  35.  36.  37.  38.  39.  40.  41.
  42.  43.  44.  45.  46.  47.  48.  49.  50.  51.  52.  53.  54.  55.
  56.  57.  58.  59.  60.  61.  62.  63.  64.  65.  66.  67.  68.  69.
  70.  71.  72.  73.  74.  75.  76.  77.  78.  79.  80.  81.  82.  83.
  84.  85.  86.  87.  88.  89.  90.  91.  92.  93.  94.  95.  96.  97.
  98.  99. 100. 101. 102. 103. 104. 105. 106. 107. 108. 109. 110. 111.
 112. 113. 114. 115. 116. 117. 118. 119. 120. 121. 122.]
2025-08-27 23:03:23,476 - root - INFO - y_train: Counter({0.0: 40947, 2.0: 1283, 3.0: 571, 6.0: 506, 1.0: 361, 14.0: 279, 11.0: 216, 40.0: 106, 8.0: 100, 7.0: 97, 25.0: 87, 12.0: 75, 18.0: 62, 97.0: 59, 45.0: 54, 32.0: 53, 53.0: 48, 42.0: 43, 31.0: 38, 74.0: 37, 29.0: 36, 15.0: 34, 13.0: 29, 46.0: 23, 43.0: 20, 37.0: 18, 28.0: 17, 30.0: 17, 59.0: 15, 44.0: 13, 22.0: 12, 17.0: 11, 64.0: 10, 5.0: 9, 16.0: 7, 21.0: 7, 23.0: 7, 38.0: 7, 51.0: 7, 41.0: 6, 10.0: 5, 33.0: 5, 56.0: 5, 76.0: 5, 89.0: 5, 101.0: 5, 19.0: 4, 20.0: 4, 50.0: 4, 69.0: 4, 75.0: 4, 80.0: 4, 82.0: 4, 4.0: 3, 49.0: 3, 54.0: 3, 55.0: 3, 85.0: 3, 102.0: 3, 9.0: 2, 24.0: 2, 35.0: 2, 52.0: 2, 62.0: 2, 65.0: 2, 67.0: 2, 68.0: 2, 70.0: 2, 78.0: 2, 79.0: 2, 83.0: 2, 84.0: 2, 88.0: 2, 91.0: 2, 92.0: 2, 94.0: 2, 100.0: 2, 104.0: 2, 107.0: 2, 118.0: 2, 119.0: 2, 26.0: 1, 27.0: 1, 34.0: 1, 36.0: 1, 39.0: 1, 47.0: 1, 48.0: 1, 57.0: 1, 58.0: 1, 60.0: 1, 61.0: 1, 63.0: 1, 66.0: 1, 71.0: 1, 72.0: 1, 73.0: 1, 77.0: 1, 81.0: 1, 86.0: 1, 87.0: 1, 90.0: 1, 93.0: 1, 95.0: 1, 96.0: 1, 98.0: 1, 99.0: 1, 103.0: 1, 105.0: 1, 106.0: 1, 108.0: 1, 109.0: 1, 110.0: 1, 111.0: 1, 112.0: 1, 113.0: 1, 114.0: 1, 115.0: 1, 116.0: 1, 117.0: 1, 120.0: 1, 121.0: 1, 122.0: 1})
2025-08-27 23:03:23,477 - root - INFO - Number of features: 16978; Number of classes: 123
Sequential(
  (0): Linear(in_features=16978, out_features=512, bias=True)
  (1): ReLU()
  (2): Linear(in_features=512, out_features=384, bias=True)
  (3): ReLU()
  (4): Linear(in_features=384, out_features=256, bias=True)
  (5): ReLU()
)
Sequential(
  (0): Linear(in_features=256, out_features=100, bias=True)
  (1): ReLU()
  (2): Dropout(p=0.2, inplace=False)
  (3): Linear(in_features=100, out_features=100, bias=True)
  (4): ReLU()
  (5): Dropout(p=0.2, inplace=False)
  (6): Linear(in_features=100, out_features=2, bias=True)
  (7): Softmax(dim=1)
)
2025-08-27 23:03:23,854 - root - INFO - Initial encoder model: ENC_MODEL_PATH models/2019-01to2019-12/enc-kld-custom-mlp-ensemble6_bin_16978-512-384-256-128_hi-dist-kld-custom-xent-ensemble6_xent100.0_mselambda1_caelambda0.1_adam_step_lr5e-05_decay0.5_half_b1024_e2.pth
2025-08-27 23:03:23,854 - root - INFO - upsample_values None
2025-08-27 23:03:23,854 - root - INFO - X_train_final.shape: (45489, 16978)
2025-08-27 23:03:23,854 - root - INFO - y_train_final.shape: (45489,)
2025-08-27 23:03:23,854 - root - INFO - y_train_binary_final.shape: (45489,)
2025-08-27 23:03:23,855 - root - INFO - y_train_final labels: [  0.   1.   2.   3.   4.   5.   6.   7.   8.   9.  10.  11.  12.  13.
  14.  15.  16.  17.  18.  19.  20.  21.  22.  23.  24.  25.  26.  27.
  28.  29.  30.  31.  32.  33.  34.  35.  36.  37.  38.  39.  40.  41.
  42.  43.  44.  45.  46.  47.  48.  49.  50.  51.  52.  53.  54.  55.
  56.  57.  58.  59.  60.  61.  62.  63.  64.  65.  66.  67.  68.  69.
  70.  71.  72.  73.  74.  75.  76.  77.  78.  79.  80.  81.  82.  83.
  84.  85.  86.  87.  88.  89.  90.  91.  92.  93.  94.  95.  96.  97.
  98.  99. 100. 101. 102. 103. 104. 105. 106. 107. 108. 109. 110. 111.
 112. 113. 114. 115. 116. 117. 118. 119. 120. 121. 122.]
2025-08-27 23:03:23,858 - root - INFO - y_train_final: Counter({0.0: 40947, 2.0: 1283, 3.0: 571, 6.0: 506, 1.0: 361, 14.0: 279, 11.0: 216, 40.0: 106, 8.0: 100, 7.0: 97, 25.0: 87, 12.0: 75, 18.0: 62, 97.0: 59, 45.0: 54, 32.0: 53, 53.0: 48, 42.0: 43, 31.0: 38, 74.0: 37, 29.0: 36, 15.0: 34, 13.0: 29, 46.0: 23, 43.0: 20, 37.0: 18, 28.0: 17, 30.0: 17, 59.0: 15, 44.0: 13, 22.0: 12, 17.0: 11, 64.0: 10, 5.0: 9, 16.0: 7, 21.0: 7, 23.0: 7, 38.0: 7, 51.0: 7, 41.0: 6, 10.0: 5, 33.0: 5, 56.0: 5, 76.0: 5, 89.0: 5, 101.0: 5, 19.0: 4, 20.0: 4, 50.0: 4, 69.0: 4, 75.0: 4, 80.0: 4, 82.0: 4, 4.0: 3, 49.0: 3, 54.0: 3, 55.0: 3, 85.0: 3, 102.0: 3, 9.0: 2, 24.0: 2, 35.0: 2, 52.0: 2, 62.0: 2, 65.0: 2, 67.0: 2, 68.0: 2, 70.0: 2, 78.0: 2, 79.0: 2, 83.0: 2, 84.0: 2, 88.0: 2, 91.0: 2, 92.0: 2, 94.0: 2, 100.0: 2, 104.0: 2, 107.0: 2, 118.0: 2, 119.0: 2, 26.0: 1, 27.0: 1, 34.0: 1, 36.0: 1, 39.0: 1, 47.0: 1, 48.0: 1, 57.0: 1, 58.0: 1, 60.0: 1, 61.0: 1, 63.0: 1, 66.0: 1, 71.0: 1, 72.0: 1, 73.0: 1, 77.0: 1, 81.0: 1, 86.0: 1, 87.0: 1, 90.0: 1, 93.0: 1, 95.0: 1, 96.0: 1, 98.0: 1, 99.0: 1, 103.0: 1, 105.0: 1, 106.0: 1, 108.0: 1, 109.0: 1, 110.0: 1, 111.0: 1, 112.0: 1, 113.0: 1, 114.0: 1, 115.0: 1, 116.0: 1, 117.0: 1, 120.0: 1, 121.0: 1, 122.0: 1})
/home/kms/github/doctor/CKLD/losses.py:504: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1704987280714/work/aten/src/ATen/native/TensorShape.cpp:3637.)
  y_norm = y.norm(dim=1).T # [1,1024] = [1024]
2025-08-27 23:03:25,836 - root - INFO - Running with configuration:
{'accumulate_data': False,
 'al': True,
 'al_epochs': 50,
 'al_optimizer': None,
 'benign_zero': True,
 'bsize': 1024,
 'cae_batch_size': 64,
 'cae_epochs': 250,
 'cae_hidden': None,
 'cae_lambda': 0.1,
 'cae_lr': 0.001,
 'classifier': 'enc-kld-custom-mlp-ensemble6',
 'cls_feat': 'input',
 'cls_retrain': 0,
 'clsdate': None,
 'cold_start': False,
 'count': None,
 'criteria': 'cred',
 'data': 'gen_androzoo_drebin',
 'display_interval': 180,
 'enc_hidden': '512-384-256-128',
 'encoder': 'enc-kld-custom-mlp-ensemble6',
 'encoder_retrain': True,
 'epochs': 2,
 'eta': 0.3,
 'eval_multi': False,
 'is_accum_samples_load': 0,
 'is_accum_samples_save': 0,
 'is_draw_tsne': 0,
 'is_enc_kld_custom_mid': 1,
 'is_only_test_eval_without_al': 1,
 'is_ovl': 0,
 'is_valid': 0,
 'kld_anneal_init': 0.1,
 'kld_anneal_warm': 0.2,
 'kld_beta': 1,
 'kld_scale': 3.0,
 'learning_rate': 5e-05,
 'local_pseudo_loss': True,
 'log_path': None,
 'loss_func': 'hi-dist-kld-custom-xent-ensemble6',
 'lr_decay_epochs': [range(10, 500, 10)],
 'lr_decay_rate': 0.5,
 'mad_threshold': 3.5,
 'margin': 10.0,
 'margin_between_b_and_m': 2.0,
 'max_depth': 6,
 'mdate': None,
 'mid_type': 'bin',
 'min_per_class': 2,
 'mlp_batch_size': 32,
 'mlp_display_interval': 300,
 'mlp_dropout': 0.2,
 'mlp_epochs': 50,
 'mlp_hidden': '100-100',
 'mlp_lr': 0.001,
 'mlp_warm_epochs': 50,
 'mlp_warm_lr': 0.001,
 'mse_lambda': 1,
 'multi_class': False,
 'num_round': 10,
 'ood': False,
 'ood_kld_ensemble': False,
 'optimizer': 'adam',
 'plb': None,
 'rand': False,
 'reduce': 'none',
 'result': 'experiments/020_revision/hc_results/hc_androzoo_mt',
 'retrain_first': 1,
 'sample_per_class': 2,
 'sample_reduce': 'mean',
 'sampler': 'half',
 'scheduler': 'step',
 'sleep': 0,
 'snapshot': False,
 'step_month': 1,
 'svm_c': 1.0,
 'test_end': '2021-12',
 'test_start': '2020-01',
 'train': None,
 'train_end': '2019-12',
 'train_start': '2019-01',
 'transcend': False,
 'triplet_lambda': 1.0,
 'unc': False,
 'valid_date': '2020-06',
 'verbose': False,
 'warm_learning_rate': 0.001,
 'xent_lambda': 100.0}
2025-08-27 23:03:25,837 - root - INFO - Loading gen_androzoo_drebin training dataset
2025-08-27 23:03:29,899 - root - INFO - Train: [1][89/89]	BT 0.043 (0.059)  DT 0.024 (0.035)  loss 38.53851 (58.47664)  hidist 5.55558 (7.51534)  kld 2.55918 (2.19345)  xent 0.30082 (0.47474)  gap 0.34167 (1.29371)
2025-08-27 23:03:29,904 - root - INFO - epoch 1, b 1024, lr 5e-05, loss 58.47664401555801, total time 5.24
2025-08-27 23:03:33,253 - root - INFO - Loaded X_train: (45489, 16978), (45489,)
2025-08-27 23:03:33,255 - root - INFO - y_train labels: [  0.   1.   2.   3.   4.   5.   6.   7.   8.   9.  10.  11.  12.  13.
  14.  15.  16.  17.  18.  19.  20.  21.  22.  23.  24.  25.  26.  27.
  28.  29.  30.  31.  32.  33.  34.  35.  36.  37.  38.  39.  40.  41.
  42.  43.  44.  45.  46.  47.  48.  49.  50.  51.  52.  53.  54.  55.
  56.  57.  58.  59.  60.  61.  62.  63.  64.  65.  66.  67.  68.  69.
  70.  71.  72.  73.  74.  75.  76.  77.  78.  79.  80.  81.  82.  83.
  84.  85.  86.  87.  88.  89.  90.  91.  92.  93.  94.  95.  96.  97.
  98.  99. 100. 101. 102. 103. 104. 105. 106. 107. 108. 109. 110. 111.
 112. 113. 114. 115. 116. 117. 118. 119. 120. 121. 122.]
2025-08-27 23:03:33,258 - root - INFO - y_train: Counter({0.0: 40947, 2.0: 1283, 3.0: 571, 6.0: 506, 1.0: 361, 14.0: 279, 11.0: 216, 40.0: 106, 8.0: 100, 7.0: 97, 25.0: 87, 12.0: 75, 18.0: 62, 97.0: 59, 45.0: 54, 32.0: 53, 53.0: 48, 42.0: 43, 31.0: 38, 74.0: 37, 29.0: 36, 15.0: 34, 13.0: 29, 46.0: 23, 43.0: 20, 37.0: 18, 28.0: 17, 30.0: 17, 59.0: 15, 44.0: 13, 22.0: 12, 17.0: 11, 64.0: 10, 5.0: 9, 16.0: 7, 21.0: 7, 23.0: 7, 38.0: 7, 51.0: 7, 41.0: 6, 10.0: 5, 33.0: 5, 56.0: 5, 76.0: 5, 89.0: 5, 101.0: 5, 19.0: 4, 20.0: 4, 50.0: 4, 69.0: 4, 75.0: 4, 80.0: 4, 82.0: 4, 4.0: 3, 49.0: 3, 54.0: 3, 55.0: 3, 85.0: 3, 102.0: 3, 9.0: 2, 24.0: 2, 35.0: 2, 52.0: 2, 62.0: 2, 65.0: 2, 67.0: 2, 68.0: 2, 70.0: 2, 78.0: 2, 79.0: 2, 83.0: 2, 84.0: 2, 88.0: 2, 91.0: 2, 92.0: 2, 94.0: 2, 100.0: 2, 104.0: 2, 107.0: 2, 118.0: 2, 119.0: 2, 26.0: 1, 27.0: 1, 34.0: 1, 36.0: 1, 39.0: 1, 47.0: 1, 48.0: 1, 57.0: 1, 58.0: 1, 60.0: 1, 61.0: 1, 63.0: 1, 66.0: 1, 71.0: 1, 72.0: 1, 73.0: 1, 77.0: 1, 81.0: 1, 86.0: 1, 87.0: 1, 90.0: 1, 93.0: 1, 95.0: 1, 96.0: 1, 98.0: 1, 99.0: 1, 103.0: 1, 105.0: 1, 106.0: 1, 108.0: 1, 109.0: 1, 110.0: 1, 111.0: 1, 112.0: 1, 113.0: 1, 114.0: 1, 115.0: 1, 116.0: 1, 117.0: 1, 120.0: 1, 121.0: 1, 122.0: 1})
2025-08-27 23:03:33,259 - root - INFO - Number of features: 16978; Number of classes: 123
Sequential(
  (0): Linear(in_features=16978, out_features=512, bias=True)
  (1): ReLU()
  (2): Linear(in_features=512, out_features=384, bias=True)
  (3): ReLU()
  (4): Linear(in_features=384, out_features=256, bias=True)
  (5): ReLU()
)
Sequential(
  (0): Linear(in_features=256, out_features=100, bias=True)
  (1): ReLU()
  (2): Dropout(p=0.2, inplace=False)
  (3): Linear(in_features=100, out_features=100, bias=True)
  (4): ReLU()
  (5): Dropout(p=0.2, inplace=False)
  (6): Linear(in_features=100, out_features=2, bias=True)
  (7): Softmax(dim=1)
)
2025-08-27 23:03:33,728 - root - INFO - Initial encoder model: ENC_MODEL_PATH models/2019-01to2019-12/enc-kld-custom-mlp-ensemble6_bin_16978-512-384-256-128_hi-dist-kld-custom-xent-ensemble6_xent100.0_mselambda1_caelambda0.1_adam_step_lr5e-05_decay0.5_half_b1024_e2.pth
2025-08-27 23:03:33,728 - root - INFO - upsample_values None
2025-08-27 23:03:33,728 - root - INFO - X_train_final.shape: (45489, 16978)
2025-08-27 23:03:33,728 - root - INFO - y_train_final.shape: (45489,)
2025-08-27 23:03:33,728 - root - INFO - y_train_binary_final.shape: (45489,)
2025-08-27 23:03:33,730 - root - INFO - y_train_final labels: [  0.   1.   2.   3.   4.   5.   6.   7.   8.   9.  10.  11.  12.  13.
  14.  15.  16.  17.  18.  19.  20.  21.  22.  23.  24.  25.  26.  27.
  28.  29.  30.  31.  32.  33.  34.  35.  36.  37.  38.  39.  40.  41.
  42.  43.  44.  45.  46.  47.  48.  49.  50.  51.  52.  53.  54.  55.
  56.  57.  58.  59.  60.  61.  62.  63.  64.  65.  66.  67.  68.  69.
  70.  71.  72.  73.  74.  75.  76.  77.  78.  79.  80.  81.  82.  83.
  84.  85.  86.  87.  88.  89.  90.  91.  92.  93.  94.  95.  96.  97.
  98.  99. 100. 101. 102. 103. 104. 105. 106. 107. 108. 109. 110. 111.
 112. 113. 114. 115. 116. 117. 118. 119. 120. 121. 122.]
2025-08-27 23:03:33,736 - root - INFO - y_train_final: Counter({0.0: 40947, 2.0: 1283, 3.0: 571, 6.0: 506, 1.0: 361, 14.0: 279, 11.0: 216, 40.0: 106, 8.0: 100, 7.0: 97, 25.0: 87, 12.0: 75, 18.0: 62, 97.0: 59, 45.0: 54, 32.0: 53, 53.0: 48, 42.0: 43, 31.0: 38, 74.0: 37, 29.0: 36, 15.0: 34, 13.0: 29, 46.0: 23, 43.0: 20, 37.0: 18, 28.0: 17, 30.0: 17, 59.0: 15, 44.0: 13, 22.0: 12, 17.0: 11, 64.0: 10, 5.0: 9, 16.0: 7, 21.0: 7, 23.0: 7, 38.0: 7, 51.0: 7, 41.0: 6, 10.0: 5, 33.0: 5, 56.0: 5, 76.0: 5, 89.0: 5, 101.0: 5, 19.0: 4, 20.0: 4, 50.0: 4, 69.0: 4, 75.0: 4, 80.0: 4, 82.0: 4, 4.0: 3, 49.0: 3, 54.0: 3, 55.0: 3, 85.0: 3, 102.0: 3, 9.0: 2, 24.0: 2, 35.0: 2, 52.0: 2, 62.0: 2, 65.0: 2, 67.0: 2, 68.0: 2, 70.0: 2, 78.0: 2, 79.0: 2, 83.0: 2, 84.0: 2, 88.0: 2, 91.0: 2, 92.0: 2, 94.0: 2, 100.0: 2, 104.0: 2, 107.0: 2, 118.0: 2, 119.0: 2, 26.0: 1, 27.0: 1, 34.0: 1, 36.0: 1, 39.0: 1, 47.0: 1, 48.0: 1, 57.0: 1, 58.0: 1, 60.0: 1, 61.0: 1, 63.0: 1, 66.0: 1, 71.0: 1, 72.0: 1, 73.0: 1, 77.0: 1, 81.0: 1, 86.0: 1, 87.0: 1, 90.0: 1, 93.0: 1, 95.0: 1, 96.0: 1, 98.0: 1, 99.0: 1, 103.0: 1, 105.0: 1, 106.0: 1, 108.0: 1, 109.0: 1, 110.0: 1, 111.0: 1, 112.0: 1, 113.0: 1, 114.0: 1, 115.0: 1, 116.0: 1, 117.0: 1, 120.0: 1, 121.0: 1, 122.0: 1})
/home/kms/github/doctor/CKLD/losses.py:504: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1704987280714/work/aten/src/ATen/native/TensorShape.cpp:3637.)
  y_norm = y.norm(dim=1).T # [1,1024] = [1024]
2025-08-27 23:03:35,510 - root - INFO - Train: [2][89/89]	BT 0.054 (0.063)  DT 0.029 (0.038)  loss 17.39279 (30.57375)  hidist 2.32366 (3.71165)  kld 1.72693 (6.83557)  xent 0.13240 (0.19892)  gap 0.10264 (0.13407)
2025-08-27 23:03:35,516 - root - INFO - epoch 2, b 1024, lr 5e-05, loss 30.573746918012414, total time 5.61
2025-08-27 23:03:35,523 - root - INFO - Training Encoder model time: 11.664 seconds
2025-08-27 23:03:35,523 - root - INFO - Saving the model...
==> Saving...
2025-08-27 23:03:35,808 - root - INFO - Training Encoder model finished: models/2019-01to2019-12/enc-kld-custom-mlp-ensemble6_bin_16978-512-384-256-128_hi-dist-kld-custom-xent-ensemble6_xent100.0_mselambda1_caelambda0.1_adam_step_lr5e-05_decay0.5_half_b1024_e2.pth
2025-08-27 23:03:37,560 - root - INFO - X_test.shape (3318, 16978)
2025-08-27 23:03:37,560 - root - INFO - y_test.shape (3318,)
2025-08-27 23:03:37,560 - root - INFO - y_test_family.shape (333,)
2025-08-27 23:03:37,641 - root - INFO - Testing on 2020-01
2025-08-27 23:03:38,383 - root - INFO - X_test.shape (4103, 16978)
2025-08-27 23:03:38,383 - root - INFO - y_test.shape (4103,)
2025-08-27 23:03:38,383 - root - INFO - y_test_family.shape (406,)
2025-08-27 23:03:38,497 - root - INFO - Testing on 2020-02
2025-08-27 23:03:39,287 - root - INFO - X_test.shape (3667, 16978)
2025-08-27 23:03:39,287 - root - INFO - y_test.shape (3667,)
2025-08-27 23:03:39,287 - root - INFO - y_test_family.shape (366,)
2025-08-27 23:03:39,379 - root - INFO - Testing on 2020-03
2025-08-27 23:03:40,158 - root - INFO - X_test.shape (3303, 16978)
2025-08-27 23:03:40,158 - root - INFO - y_test.shape (3303,)
2025-08-27 23:03:40,158 - root - INFO - y_test_family.shape (337,)
2025-08-27 23:03:40,233 - root - INFO - Testing on 2020-04
2025-08-27 23:03:40,901 - root - INFO - X_test.shape (3797, 16978)
2025-08-27 23:03:40,901 - root - INFO - y_test.shape (3797,)
2025-08-27 23:03:40,901 - root - INFO - y_test_family.shape (389,)
2025-08-27 23:03:40,973 - root - INFO - Train: [1][89/89]	BT 0.070 (0.073)  DT 0.040 (0.043)  loss 32.09841 (54.11046)  hidist 5.11601 (7.50014)  kld 2.41483 (2.96323)  xent 0.24172 (0.42225)  gap 0.39554 (1.42224)
2025-08-27 23:03:40,978 - root - INFO - epoch 1, b 1024, lr 5e-05, loss 54.11046448916203, total time 6.53
2025-08-27 23:03:41,010 - root - INFO - Testing on 2020-05
2025-08-27 23:03:41,468 - root - INFO - X_test.shape (1949, 16978)
2025-08-27 23:03:41,468 - root - INFO - y_test.shape (1949,)
2025-08-27 23:03:41,468 - root - INFO - y_test_family.shape (197,)
2025-08-27 23:03:41,513 - root - INFO - Testing on 2020-06
2025-08-27 23:03:42,424 - root - INFO - X_test.shape (4826, 16978)
2025-08-27 23:03:42,424 - root - INFO - y_test.shape (4826,)
2025-08-27 23:03:42,424 - root - INFO - y_test_family.shape (492,)
2025-08-27 23:03:42,547 - root - INFO - Testing on 2020-07
2025-08-27 23:03:43,501 - root - INFO - X_test.shape (4721, 16978)
2025-08-27 23:03:43,501 - root - INFO - y_test.shape (4721,)
2025-08-27 23:03:43,501 - root - INFO - y_test_family.shape (491,)
2025-08-27 23:03:43,625 - root - INFO - Testing on 2020-08
2025-08-27 23:03:44,270 - root - INFO - X_test.shape (2729, 16978)
2025-08-27 23:03:44,270 - root - INFO - y_test.shape (2729,)
2025-08-27 23:03:44,270 - root - INFO - y_test_family.shape (288,)
2025-08-27 23:03:44,343 - root - INFO - Testing on 2020-09
2025-08-27 23:03:44,749 - root - INFO - X_test.shape (1651, 16978)
2025-08-27 23:03:44,750 - root - INFO - y_test.shape (1651,)
2025-08-27 23:03:44,750 - root - INFO - y_test_family.shape (170,)
2025-08-27 23:03:44,797 - root - INFO - Testing on 2020-10
2025-08-27 23:03:45,089 - root - INFO - X_test.shape (1273, 16978)
2025-08-27 23:03:45,089 - root - INFO - y_test.shape (1273,)
2025-08-27 23:03:45,089 - root - INFO - y_test_family.shape (134,)
2025-08-27 23:03:45,136 - root - INFO - Testing on 2020-11
2025-08-27 23:03:45,758 - root - INFO - X_test.shape (3567, 16978)
2025-08-27 23:03:45,759 - root - INFO - y_test.shape (3567,)
2025-08-27 23:03:45,759 - root - INFO - y_test_family.shape (380,)
2025-08-27 23:03:45,863 - root - INFO - Testing on 2020-12
2025-08-27 23:03:46,604 - root - INFO - X_test.shape (4151, 16978)
2025-08-27 23:03:46,604 - root - INFO - y_test.shape (4151,)
2025-08-27 23:03:46,604 - root - INFO - y_test_family.shape (445,)
2025-08-27 23:03:46,656 - root - INFO - Train: [2][89/89]	BT 0.079 (0.064)  DT 0.023 (0.037)  loss 15.78520 (28.66306)  hidist 1.44163 (3.46427)  kld 1.74910 (7.27919)  xent 0.12517 (0.17794)  gap 0.07792 (0.12578)
2025-08-27 23:03:46,661 - root - INFO - epoch 2, b 1024, lr 5e-05, loss 28.66306333716508, total time 5.68
2025-08-27 23:03:46,668 - root - INFO - Training Encoder model time: 12.932 seconds
2025-08-27 23:03:46,668 - root - INFO - Saving the model...
==> Saving...
2025-08-27 23:03:46,705 - root - INFO - Testing on 2021-01
2025-08-27 23:03:46,871 - root - INFO - X_test.shape (403, 16978)
2025-08-27 23:03:46,872 - root - INFO - y_test.shape (403,)
2025-08-27 23:03:46,872 - root - INFO - y_test_family.shape (41,)
2025-08-27 23:03:46,884 - root - INFO - Testing on 2021-02
2025-08-27 23:03:46,961 - root - INFO - Training Encoder model finished: models/2019-01to2019-12/enc-kld-custom-mlp-ensemble6_bin_16978-512-384-256-128_hi-dist-kld-custom-xent-ensemble6_xent100.0_mselambda1_caelambda0.1_adam_step_lr5e-05_decay0.5_half_b1024_e2.pth
2025-08-27 23:03:47,343 - root - INFO - X_test.shape (1215, 16978)
2025-08-27 23:03:47,343 - root - INFO - y_test.shape (1215,)
2025-08-27 23:03:47,343 - root - INFO - y_test_family.shape (128,)
2025-08-27 23:03:47,394 - root - INFO - Testing on 2021-03
2025-08-27 23:03:47,576 - root - INFO - X_test.shape (692, 16978)
2025-08-27 23:03:47,576 - root - INFO - y_test.shape (692,)
2025-08-27 23:03:47,576 - root - INFO - y_test_family.shape (73,)
2025-08-27 23:03:47,597 - root - INFO - Testing on 2021-04
2025-08-27 23:03:47,716 - root - INFO - X_test.shape (644, 16978)
2025-08-27 23:03:47,716 - root - INFO - y_test.shape (644,)
2025-08-27 23:03:47,716 - root - INFO - y_test_family.shape (68,)
2025-08-27 23:03:47,737 - root - INFO - Testing on 2021-05
2025-08-27 23:03:47,826 - root - INFO - X_test.shape (459, 16978)
2025-08-27 23:03:47,826 - root - INFO - y_test.shape (459,)
2025-08-27 23:03:47,826 - root - INFO - y_test_family.shape (44,)
2025-08-27 23:03:47,961 - root - INFO - Testing on 2021-06
2025-08-27 23:03:48,428 - root - INFO - X_test.shape (2503, 16978)
2025-08-27 23:03:48,428 - root - INFO - y_test.shape (2503,)
2025-08-27 23:03:48,428 - root - INFO - y_test_family.shape (262,)
2025-08-27 23:03:48,486 - root - INFO - Testing on 2021-07
2025-08-27 23:03:48,646 - root - INFO - X_test.shape (3318, 16978)
2025-08-27 23:03:48,646 - root - INFO - y_test.shape (3318,)
2025-08-27 23:03:48,646 - root - INFO - y_test_family.shape (333,)
2025-08-27 23:03:48,720 - root - INFO - Testing on 2020-01
2025-08-27 23:03:48,908 - root - INFO - X_test.shape (1568, 16978)
2025-08-27 23:03:48,908 - root - INFO - y_test.shape (1568,)
2025-08-27 23:03:48,908 - root - INFO - y_test_family.shape (173,)
2025-08-27 23:03:48,947 - root - INFO - Testing on 2021-08
2025-08-27 23:03:49,311 - root - INFO - X_test.shape (2095, 16978)
2025-08-27 23:03:49,311 - root - INFO - y_test.shape (2095,)
2025-08-27 23:03:49,311 - root - INFO - y_test_family.shape (228,)
2025-08-27 23:03:49,359 - root - INFO - Testing on 2021-09
2025-08-27 23:03:49,442 - root - INFO - X_test.shape (4103, 16978)
2025-08-27 23:03:49,442 - root - INFO - y_test.shape (4103,)
2025-08-27 23:03:49,442 - root - INFO - y_test_family.shape (406,)
2025-08-27 23:03:49,535 - root - INFO - Testing on 2020-02
2025-08-27 23:03:49,668 - root - INFO - X_test.shape (1073, 16978)
2025-08-27 23:03:49,668 - root - INFO - y_test.shape (1073,)
2025-08-27 23:03:49,669 - root - INFO - y_test_family.shape (120,)
2025-08-27 23:03:49,697 - root - INFO - Testing on 2021-10
2025-08-27 23:03:49,831 - root - INFO - X_test.shape (477, 16978)
2025-08-27 23:03:49,832 - root - INFO - y_test.shape (477,)
2025-08-27 23:03:49,832 - root - INFO - y_test_family.shape (54,)
2025-08-27 23:03:49,845 - root - INFO - Testing on 2021-11
2025-08-27 23:03:49,928 - root - INFO - X_test.shape (381, 16978)
2025-08-27 23:03:49,928 - root - INFO - y_test.shape (381,)
2025-08-27 23:03:49,928 - root - INFO - y_test_family.shape (40,)
2025-08-27 23:03:49,939 - root - INFO - Testing on 2021-12
2025-08-27 23:03:49,960 - root - INFO - time elapsed: 32.977826833724976 seconds
2025-08-27 23:03:50,349 - root - INFO - X_test.shape (3667, 16978)
2025-08-27 23:03:50,349 - root - INFO - y_test.shape (3667,)
2025-08-27 23:03:50,349 - root - INFO - y_test_family.shape (366,)
2025-08-27 23:03:50,433 - root - INFO - Testing on 2020-03
2025-08-27 23:03:51,096 - root - INFO - X_test.shape (3303, 16978)
2025-08-27 23:03:51,097 - root - INFO - y_test.shape (3303,)
2025-08-27 23:03:51,097 - root - INFO - y_test_family.shape (337,)
2025-08-27 23:03:51,174 - root - INFO - Testing on 2020-04
2025-08-27 23:03:51,839 - root - INFO - X_test.shape (3797, 16978)
2025-08-27 23:03:51,839 - root - INFO - y_test.shape (3797,)
2025-08-27 23:03:51,839 - root - INFO - y_test_family.shape (389,)
2025-08-27 23:03:51,922 - root - INFO - Testing on 2020-05
2025-08-27 23:03:52,299 - root - INFO - X_test.shape (1949, 16978)
2025-08-27 23:03:52,299 - root - INFO - y_test.shape (1949,)
2025-08-27 23:03:52,299 - root - INFO - y_test_family.shape (197,)
2025-08-27 23:03:52,345 - root - INFO - Testing on 2020-06
2025-08-27 23:03:53,050 - root - INFO - X_test.shape (4826, 16978)
2025-08-27 23:03:53,051 - root - INFO - y_test.shape (4826,)
2025-08-27 23:03:53,051 - root - INFO - y_test_family.shape (492,)
2025-08-27 23:03:53,156 - root - INFO - Testing on 2020-07
2025-08-27 23:03:54,221 - root - INFO - X_test.shape (4721, 16978)
2025-08-27 23:03:54,221 - root - INFO - y_test.shape (4721,)
2025-08-27 23:03:54,221 - root - INFO - y_test_family.shape (491,)
2025-08-27 23:03:54,319 - root - INFO - Testing on 2020-08
2025-08-27 23:03:54,823 - root - INFO - X_test.shape (2729, 16978)
2025-08-27 23:03:54,823 - root - INFO - y_test.shape (2729,)
2025-08-27 23:03:54,823 - root - INFO - y_test_family.shape (288,)
2025-08-27 23:03:54,882 - root - INFO - Testing on 2020-09
2025-08-27 23:03:55,191 - root - INFO - X_test.shape (1651, 16978)
2025-08-27 23:03:55,191 - root - INFO - y_test.shape (1651,)
2025-08-27 23:03:55,191 - root - INFO - y_test_family.shape (170,)
2025-08-27 23:03:55,229 - root - INFO - Testing on 2020-10
2025-08-27 23:03:55,471 - root - INFO - X_test.shape (1273, 16978)
2025-08-27 23:03:55,472 - root - INFO - y_test.shape (1273,)
2025-08-27 23:03:55,472 - root - INFO - y_test_family.shape (134,)
2025-08-27 23:03:55,501 - root - INFO - Testing on 2020-11
2025-08-27 23:03:56,040 - root - INFO - X_test.shape (3567, 16978)
2025-08-27 23:03:56,040 - root - INFO - y_test.shape (3567,)
2025-08-27 23:03:56,040 - root - INFO - y_test_family.shape (380,)
2025-08-27 23:03:56,119 - root - INFO - Testing on 2020-12
2025-08-27 23:03:56,788 - root - INFO - X_test.shape (4151, 16978)
2025-08-27 23:03:56,788 - root - INFO - y_test.shape (4151,)
2025-08-27 23:03:56,788 - root - INFO - y_test_family.shape (445,)
2025-08-27 23:03:56,873 - root - INFO - Testing on 2021-01
2025-08-27 23:03:57,017 - root - INFO - X_test.shape (403, 16978)
2025-08-27 23:03:57,017 - root - INFO - y_test.shape (403,)
2025-08-27 23:03:57,017 - root - INFO - y_test_family.shape (41,)
2025-08-27 23:03:57,029 - root - INFO - Testing on 2021-02
2025-08-27 23:03:57,213 - root - INFO - X_test.shape (1215, 16978)
2025-08-27 23:03:57,213 - root - INFO - y_test.shape (1215,)
2025-08-27 23:03:57,213 - root - INFO - y_test_family.shape (128,)
2025-08-27 23:03:57,240 - root - INFO - Testing on 2021-03
2025-08-27 23:03:57,369 - root - INFO - X_test.shape (692, 16978)
2025-08-27 23:03:57,369 - root - INFO - y_test.shape (692,)
2025-08-27 23:03:57,369 - root - INFO - y_test_family.shape (73,)
2025-08-27 23:03:57,386 - root - INFO - Testing on 2021-04
2025-08-27 23:03:57,495 - root - INFO - X_test.shape (644, 16978)
2025-08-27 23:03:57,495 - root - INFO - y_test.shape (644,)
2025-08-27 23:03:57,495 - root - INFO - y_test_family.shape (68,)
2025-08-27 23:03:57,512 - root - INFO - Testing on 2021-05
2025-08-27 23:03:57,594 - root - INFO - X_test.shape (459, 16978)
2025-08-27 23:03:57,594 - root - INFO - y_test.shape (459,)
2025-08-27 23:03:57,594 - root - INFO - y_test_family.shape (44,)
2025-08-27 23:03:57,607 - root - INFO - Testing on 2021-06
2025-08-27 23:03:57,986 - root - INFO - X_test.shape (2503, 16978)
2025-08-27 23:03:57,986 - root - INFO - y_test.shape (2503,)
2025-08-27 23:03:57,986 - root - INFO - y_test_family.shape (262,)
2025-08-27 23:03:58,040 - root - INFO - Testing on 2021-07
2025-08-27 23:03:58,344 - root - INFO - X_test.shape (1568, 16978)
2025-08-27 23:03:58,344 - root - INFO - y_test.shape (1568,)
2025-08-27 23:03:58,344 - root - INFO - y_test_family.shape (173,)
2025-08-27 23:03:58,381 - root - INFO - Testing on 2021-08
2025-08-27 23:03:58,771 - root - INFO - X_test.shape (2095, 16978)
2025-08-27 23:03:58,771 - root - INFO - y_test.shape (2095,)
2025-08-27 23:03:58,771 - root - INFO - y_test_family.shape (228,)
2025-08-27 23:03:58,818 - root - INFO - Testing on 2021-09
2025-08-27 23:03:59,027 - root - INFO - X_test.shape (1073, 16978)
2025-08-27 23:03:59,027 - root - INFO - y_test.shape (1073,)
2025-08-27 23:03:59,027 - root - INFO - y_test_family.shape (120,)
2025-08-27 23:03:59,055 - root - INFO - Testing on 2021-10
2025-08-27 23:03:59,154 - root - INFO - X_test.shape (477, 16978)
2025-08-27 23:03:59,154 - root - INFO - y_test.shape (477,)
2025-08-27 23:03:59,154 - root - INFO - y_test_family.shape (54,)
2025-08-27 23:03:59,167 - root - INFO - Testing on 2021-11
2025-08-27 23:03:59,258 - root - INFO - X_test.shape (381, 16978)
2025-08-27 23:03:59,258 - root - INFO - y_test.shape (381,)
2025-08-27 23:03:59,258 - root - INFO - y_test_family.shape (40,)
2025-08-27 23:03:59,268 - root - INFO - Testing on 2021-12
2025-08-27 23:03:59,288 - root - INFO - time elapsed: 33.45319199562073 seconds
